# Transaction 트랜잭션

트랜잭션의 기본 개념은 더 이상 쪼갤 수 없는 최소 단위의 작업이다.

## 트랜잭션 전파

트랜잭션의 경계에서 이미 진행 중인 트랜잭션이 있을 때, 또는 없을 때 어떻게 동작할 것인가를 결정하는 방식

- A, B 두 트랜잭션이 호출될 때
    - B는  A와 무관한 독립적인 새 트랜잭션 만들기
    - B는 새로운 트랜잭션을 만들지 않고 A 트랜잭션에 포함되어 진행
- **PROPAGATION_REQUIRED**
    - 진행 중인 트랜잭션이 없으면 새로 시작하고, 이미 시작된 트랜잭션이 있으면 이에 참여한다.
      이는 다양한 방식으로 결합해서 하나의 트랜잭션으로 구성하기 쉽다. A, B, A->B, B->A와 같은 4가지의 트랜잭션이 모두 가능하다.
- **PROPAGATION_REQUIRES_NEW**
    - 항상 새로운 트랜잭션을 시작한다.
- **PROPAGATION_NOT_SUPPORTED**
    - 트랜잭션 없이 동작하도록 만든다. 메서드 중 특별한 메서드만 트랜잭션 적용에서 제외할 때 사용한다.
      보통 모든 메서드에 트랜잭션 AOP가 적용되게 하고, 특정 메서드의 트랜잭션 전파 속성만 PROPAGATION_NOT_SUPPORTED로 설정한다.


## 격리 수준

모든 DB 트랜잭션은 격리 수준을 갖고 있어야 한다. 기본적으로 DB에 설정되어 있지만,
JDBC 드라이버나 DataSource 등에서 재설정할 수 있고, 트랜잭션 단위로 격리수준을 조정할 수 있다.

DefaultTransactionDefinition에 설정된 격리 수준은 `ISOLATION_DEFAULT`이다.
이는 DataSource에 설정된 디폴트 격리수준을 그대로 따른다는 것이다.